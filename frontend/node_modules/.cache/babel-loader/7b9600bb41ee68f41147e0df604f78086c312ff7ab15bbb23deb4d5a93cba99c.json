{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import axios from\"axios\";import API_BASE_URL from\"../config/api\";import SideNav from\"../components/SideNav\";import\"../styles/Reports.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Reports=()=>{const[token,setToken]=useState(localStorage.getItem(\"token\")||\"\");const[sessionList,setSessionList]=useState([]);const[loading,setLoading]=useState(true);const[filter,setFilter]=useState(\"all\");// all, present, late\nconst[sortBy,setSortBy]=useState(\"date\");// date, course, status\nconst[searchTerm,setSearchTerm]=useState(\"\");const navigate=useNavigate();// Get student sessions\nfunction getStudentSessions(){setLoading(true);axios.post(\"\".concat(API_BASE_URL,\"/sessions/getStudentSessions\"),{token:token}).then(response=>{setSessionList(response.data.sessions||[]);setLoading(false);}).catch(err=>{console.log(\"Error fetching student sessions:\",err);setSessionList([]);setLoading(false);});}function getDistance(distance,radius){return{distance,color:distance<=parseFloat(radius)?\"green\":\"red\",status:distance<=parseFloat(radius)?\"present\":\"late\"};}// Filter and sort sessions\nconst filteredSessions=sessionList.filter(session=>{const matchesSearch=session.name.toLowerCase().includes(searchTerm.toLowerCase());const sessionStatus=getDistance(session.distance,session.radius).status;if(filter===\"all\")return matchesSearch;return matchesSearch&&sessionStatus===filter;}).sort((a,b)=>{switch(sortBy){case\"date\":return new Date(b.date)-new Date(a.date);case\"course\":return a.name.localeCompare(b.name);case\"status\":const aStatus=getDistance(a.distance,a.radius).status;const bStatus=getDistance(b.distance,b.radius).status;return aStatus.localeCompare(bStatus);default:return 0;}});// Calculate statistics\nconst stats={total:sessionList.length,present:sessionList.filter(s=>getDistance(s.distance,s.radius).status===\"present\").length,late:sessionList.filter(s=>getDistance(s.distance,s.radius).status===\"late\").length,attendanceRate:sessionList.length>0?Math.round(sessionList.filter(s=>getDistance(s.distance,s.radius).status===\"present\").length/sessionList.length*100):0};useEffect(()=>{if(token===\"\"||token===undefined){navigate(\"/login\");}else{getStudentSessions();}},[token,navigate]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"app-container\",children:[/*#__PURE__*/_jsx(SideNav,{userType:\"student\"}),/*#__PURE__*/_jsx(\"div\",{className:\"main-content-area\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"reports-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"reports-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83D\\uDCCA Attendance \"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"stats-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card total\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",children:\"\\uD83D\\uDCDA\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-info\",children:[/*#__PURE__*/_jsx(\"h3\",{children:stats.total}),/*#__PURE__*/_jsx(\"p\",{children:\"Total Sessions\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card present\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",children:\"\\u2705\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-info\",children:[/*#__PURE__*/_jsx(\"h3\",{children:stats.present}),/*#__PURE__*/_jsx(\"p\",{children:\"Present\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card late\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-info\",children:[/*#__PURE__*/_jsx(\"h3\",{children:stats.late}),/*#__PURE__*/_jsx(\"p\",{children:\"Late\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card rate\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-icon\",children:\"\\uD83D\\uDCC8\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-info\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[stats.attendanceRate,\"%\"]}),/*#__PURE__*/_jsx(\"p\",{children:\"Attendance Rate\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"controls-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"search-container\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\uD83D\\uDD0D Search by course name...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"search-input\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-controls\",children:[/*#__PURE__*/_jsxs(\"select\",{value:filter,onChange:e=>setFilter(e.target.value),className:\"filter-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All Sessions\"}),/*#__PURE__*/_jsx(\"option\",{value:\"present\",children:\"Present Only\"}),/*#__PURE__*/_jsx(\"option\",{value:\"late\",children:\"Late Only\"})]}),/*#__PURE__*/_jsxs(\"select\",{value:sortBy,onChange:e=>setSortBy(e.target.value),className:\"sort-select\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"date\",children:\"Sort by Date\"}),/*#__PURE__*/_jsx(\"option\",{value:\"course\",children:\"Sort by Course\"}),/*#__PURE__*/_jsx(\"option\",{value:\"status\",children:\"Sort by Status\"})]})]})]}),loading?/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading attendance records...\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"attendance-report-list\",children:filteredSessions.length>0?filteredSessions.map((session,index)=>{const distanceInfo=getDistance(session.distance,session.radius);return/*#__PURE__*/_jsxs(\"div\",{className:\"report-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"report-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"course-details\",children:[/*#__PURE__*/_jsx(\"h3\",{children:session.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"session-metadata\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"date\",children:[\"\\uD83D\\uDCC5 \",new Date(session.date).toLocaleDateString('en-US',{weekday:'short',year:'numeric',month:'short',day:'numeric'})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"time\",children:[\"\\u23F0 \",session.time]}),/*#__PURE__*/_jsxs(\"span\",{className:\"duration\",children:[\"\\u23F1\\uFE0F \",session.duration]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"status-section\",children:/*#__PURE__*/_jsx(\"span\",{className:\"status-indicator \".concat(distanceInfo.status),children:distanceInfo.status==='present'?'✅ Present':'⚠️ Late'})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"report-details\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"detail-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"\\uD83D\\uDCCD Distance\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value distance-\".concat(distanceInfo.color),children:[session.distance,\"m / \",session.radius,\"m limit\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"\\uD83D\\uDCF8 Photo\"}),/*#__PURE__*/_jsx(\"img\",{src:session.image,alt:\"Attendance verification\",className:\"report-photo\",onClick:()=>window.open(session.image,'_blank')})]})]})})]},index);}):/*#__PURE__*/_jsxs(\"div\",{className:\"no-results\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"no-results-icon\",children:\"\\uD83D\\uDD0D\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"No records found\"}),/*#__PURE__*/_jsx(\"p\",{children:searchTerm?\"No attendance records match \\\"\".concat(searchTerm,\"\\\"\"):\"No \".concat(filter==='all'?'':filter,\" attendance records found\")})]})})]})})]})});};export default Reports;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}